== Modal Component
:revdate: 2025-08-09
:revremark: Reviewed for consistency (no functional changes)
:toc:
:toc-placement: preamble
:sectnums:
:icons: font

[.lead]
A comprehensive modal dialog component with portal rendering, accessibility features, keyboard navigation, and smooth animations.

== Overview

The `Modal` component provides a full-screen overlay dialog with backdrop blur, escape key handling, focus management, and graceful fallback rendering. It uses React portals for proper DOM placement and includes comprehensive error handling.

== Component Details

[cols="1,3"]
|===
|*File Location* |`src/components/ui/Modal.tsx`
|*Component Type* |Functional Component
|*Client/Server* |Client Component (`"use client"`)
|*Export Type* |Named Export
|===

== Props Interface

[cols="1,1,3,1"]
|===
|*Prop* |*Type* |*Description* |*Required*

|children
|ReactNode
|Modal content to be rendered inside the dialog
|Yes

|isOpen
|boolean
|Controls modal visibility state
|Yes

|onClose
|() => void
|Callback function executed when modal should close
|Yes
|===

== Type Definition

[source,tsx]
----
interface IModalProps {
  children: ReactNode;
  isOpen: boolean;
  onClose: () => void;
}
----

== Features

=== Portal Rendering
* **DOM Portal**: Renders modal at document.body level using `createPortal`
* **Z-index Management**: Fixed positioning with `z-50` for proper layering
* **Fallback Rendering**: Inline rendering if portal creation fails

=== Accessibility
* **Keyboard Navigation**: ESC key closes modal
* **Screen Reader**: Proper ARIA labels for interactive elements
* **Focus Management**: Backdrop button with semantic labeling
* **Click Outside**: Backdrop click closes modal

=== Animation System
* **Smooth Transitions**: 300ms duration for all animations
* **Opacity Fade**: Backdrop and content fade in/out
* **Scale Animation**: Content scales from 95% to 100%
* **Backdrop Blur**: Progressive blur effect on background

== Technical Implementation

=== Event Handling
[source,tsx]
----
const handleEscape = useCallback(
  (event: KeyboardEvent) => {
    if (event.key === "Escape") {
      onClose();
    }
  },
  [onClose]
);
----

=== Body Scroll Management
[source,tsx]
----
useEffect(() => {
  return () => {
    document.body.style.overflow = "unset";
  };
}, [isOpen]);
----

=== Error Boundary
```tsx
try {
  return createPortal(/* Portal content */, document.body);
} catch (error) {
  console.error("Error creating modal portal:", error);
  // Fallback rendering
}
```

== Usage Examples

=== Basic Modal Implementation

[source,tsx]
----
import { Modal } from "@/components/ui/Modal";
import { useState } from "react";

const MyComponent = () => {
  const [isModalOpen, setIsModalOpen] = useState(false);

  return (
    <>
      <button onClick={() => setIsModalOpen(true)}>
        Open Modal
      </button>

      <Modal
        isOpen={isModalOpen}
        onClose={() => setIsModalOpen(false)}
      >
        <div className="p-6 bg-white rounded-lg">
          <h2>Modal Title</h2>
          <p>Modal content goes here...</p>
        </div>
      </Modal>
    </>
  );
};
----

=== Form Modal

[source,tsx]
----
<Modal isOpen={showForm} onClose={handleCloseForm}>
  <form className="bg-gray-800 rounded-2xl p-8">
    <h2 className="text-xl font-bold mb-4">Contact Form</h2>
    <input
      type="text"
      placeholder="Name"
      className="w-full p-3 mb-4 rounded-lg"
    />
    <button type="submit" className="btn-primary">
      Submit
    </button>
  </form>
</Modal>
----

=== Confirmation Dialog

[source,tsx]
----
<Modal isOpen={showConfirm} onClose={() => setShowConfirm(false)}>
  <div className="bg-white rounded-xl p-6 text-center">
    <h3 className="text-lg font-semibold mb-4">Confirm Action</h3>
    <p className="mb-6">Are you sure you want to proceed?</p>
    <div className="flex gap-4 justify-center">
      <button onClick={handleConfirm} className="btn-primary">
        Confirm
      </button>
      <button onClick={() => setShowConfirm(false)} className="btn-secondary">
        Cancel
      </button>
    </div>
  </div>
</Modal>
----

== Styling Architecture

=== Container Classes
```css
.modal-container {
  @apply fixed inset-0 z-50 flex items-center justify-center;
  @apply transition-all duration-300;
}

.modal-backdrop {
  @apply absolute inset-0 cursor-pointer bg-black/60 backdrop-blur-sm;
  @apply transition-all duration-300;
}

.modal-content {
  @apply relative z-10 mx-4 w-full max-w-lg transform;
  @apply transition-all duration-300;
}
```

=== Animation States
[cols="1,2,2"]
|===
|*State* |*Backdrop* |*Content*

|Closed
|`opacity-0`
|`scale-95 opacity-0`

|Open
|`opacity-100`
|`scale-100 opacity-100`
|===

== Accessibility Implementation

=== Keyboard Support
* **ESC Key**: Closes modal when pressed
* **Tab Navigation**: Natural focus flow within modal content
* **Focus Trapping**: Content contained within modal boundaries

=== Screen Reader Support
* **ARIA Labels**: Backdrop button labeled "Close modal"
* **Semantic Structure**: Proper heading hierarchy in content
* **Focus Management**: Logical tab order for interactive elements

=== Mouse/Touch Support
* **Click Outside**: Backdrop click closes modal
* **Touch Events**: Full touch device compatibility
* **Responsive**: Works across all device sizes

== Performance Considerations

=== Optimization Features
* **Portal Rendering**: Prevents layout recalculations in parent components
* **Event Delegation**: Efficient keyboard event handling
* **Lazy Rendering**: Modal only renders when `isOpen` is true
* **Memory Management**: Proper cleanup of event listeners

=== Bundle Impact
* **Minimal Dependencies**: Only essential React hooks
* **Tree Shaking**: Unused functions eliminated
* **CSS Classes**: Utility-based approach for minimal runtime cost

== Error Handling

=== Portal Fallback
When `createPortal` fails, the component gracefully falls back to inline rendering:

[source,tsx]
----
try {
  return createPortal(modalContent, document.body);
} catch (error) {
  console.error("Error creating modal portal:", error);
  return modalContent; // Inline fallback
}
----

=== Body Overflow Management
Automatic cleanup prevents scroll issues:
```tsx
useEffect(() => {
  return () => {
    document.body.style.overflow = "unset";
  };
}, [isOpen]);
```

== Best Practices

=== Usage Guidelines
* **Single Purpose**: One modal per feature or workflow
* **Clear Actions**: Provide obvious close mechanisms
* **Content Size**: Keep content within reasonable viewport bounds
* **Loading States**: Handle async operations within modal content

=== Performance Tips
* **Conditional Rendering**: Only render when needed
* **Content Optimization**: Minimize modal content complexity
* **Event Cleanup**: Component handles cleanup automatically
* **Portal Benefits**: Leverage portal for z-index management

=== Accessibility Best Practices
* **Focus Management**: Ensure logical tab order
* **Keyboard Support**: Always provide ESC key support
* **Screen Readers**: Use proper ARIA labels and semantic HTML
* **Color Contrast**: Ensure sufficient contrast in content

== Common Integration Patterns

=== State Management
[source,tsx]
----
const [modalState, setModalState] = useState({
  isOpen: false,
  content: null,
  onConfirm: null
});

const openModal = (content, onConfirm) => {
  setModalState({ isOpen: true, content, onConfirm });
};
----

=== Form Integration
[source,tsx]
----
const handleFormSubmit = async (data) => {
  try {
    await submitForm(data);
    onClose(); // Close modal on success
  } catch (error) {
    // Handle error within modal
  }
};
----

=== Context Integration
[source,tsx]
----
const { showModal, hideModal } = useModalContext();

// Global modal management
const openContactForm = () => {
  showModal(<ContactForm onClose={hideModal} />);
};
----

== Dependencies

[cols="1,1,2"]
|===
|*Package* |*Import* |*Usage*

|react
|ReactNode, useCallback, useEffect
|Component structure and lifecycle management

|react-dom
|createPortal
|Portal rendering for proper DOM placement
|===

== Related Components

* **ContactModal**: Specialized modal for contact forms
* **Card**: Similar glassmorphism design principles
* **ErrorBoundary**: Error handling for modal content

== Change History

[cols="1,1,3"]
|===
|*Version* |*Date* |*Changes*

|1.0.0
|Current
|Initial implementation with portal rendering and accessibility features
|===
