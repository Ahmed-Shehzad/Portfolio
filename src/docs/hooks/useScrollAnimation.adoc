= useScrollAnimation Hook
:toc:
:toc-placement: preamble
:sectnums:
:icons: font
:revdate: 2025-08-09
:revremark: Initial documentation

[.lead]
IntersectionObserver + optional delayed activation for triggering CSS animation classes when elements scroll into view.

== Overview
`useScrollAnimation` supplies an element ref and a boolean `isVisible` that becomes true once intersection threshold conditions are met. Supports optional delay and a one-time trigger mode for performance.

== Hook Signature
[source,typescript]
----
interface UseScrollAnimationOptions {
  threshold?: number;        // default 0.1
  rootMargin?: string;       // default "0px 0px -100px 0px"
  triggerOnce?: boolean;     // default true
  delay?: number;            // ms, default 0
}

const { elementRef, isVisible } = useScrollAnimation(options);
----

== Behavior
* Creates IntersectionObserver with supplied `threshold` & `rootMargin`.
* On intersect: optionally delays state flip via bfcache-compatible timeout.
* If `triggerOnce`, unobserves element after first reveal.
* Recreates observer if page restored from bfcache (pageshow.persisted).

== Usage
[source,tsx]
----
const { elementRef, isVisible } = useScrollAnimation({ threshold: 0.2, delay: 150 });

return (
  <div ref={elementRef} className={isVisible ? "animate-fadeInUp" : "opacity-0"}>
    Animated content...
  </div>
);
----

== Integration: ScrollAnimationWrapper
Higher-level wrapper consumes this hook and maps `isVisible` to variant class names, optionally staggering children.

== Performance Notes
* Observer disconnected once not needed (triggerOnce).
* Delay scheduling uses bfcache-safe timeout hook.
* Keeps logic declarativeâ€”CSS handles animation frames.

== Accessibility
* Avoid using visibility animations on critical interactive elements required immediately for keyboard users.
* Ensure hidden state still preserves layout or provide fallback.

== Change History
[cols="1,1,3"]
|===
|*Version* |*Date* |*Changes*
|1.0.0 |2025-08-09 |Initial documentation
|===
